!function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";n.r(t);
/*!
 * Utilities for Web Request RPC.
 *
 * Copyright (c) 2017 Digital Bazaar, Inc. All rights reserved.
 */
const i={ParseError:{message:"Parse error",code:-32700},InvalidRequest:{message:"Invalid Request",code:-32600},MethodNotFound:{message:"Method not found",code:-32601},InvalidParams:{message:"Invalid params",code:-32602},InternalError:{message:"Internal Error",code:-32603},ServerError:{message:"Server error",code:-32e3}};function r(e,t){if(void 0===t&&(t=window.location.href),"undefined"!=typeof URL)return new URL(e,t);if("string"!=typeof e)throw new TypeError('"url" must be a string.');e.includes(":")||(e=t.startsWith("http")&&!e.startsWith("/")?t+"/"+e:t+e);const n=document.createElement("a");n.href=e;let i=(n.protocol||window.location.protocol)+"//";return n.host?"http:"===n.protocol&&"80"===n.port||"https:"===n.protocol&&"443"===n.port?i+=n.hostname:i+=n.host:i+=window.location.host,{host:n.host||window.location.host,hostname:n.hostname,origin:i,protocol:n.protocol,pathname:n.pathname}}function o(e){return e&&"object"==typeof e&&"2.0"===e.jsonrpc&&e.id&&"string"==typeof e.id}function s({listener:e,origin:t,handle:n,expectRequest:i}){if(a(n)){const e=n;n=!1,e.then(e=>n=e)}return r=>{r.source===n&&r.origin===t&&(i&&function(e){return o(e)&&Array.isArray(e.params)}(r.data)||!i&&function(e){return o(e)&&!!("result"in e^"error"in e)&&(!("error"in e)||function(e){return e&&"object"==typeof e&&"number"==typeof e.code&&"string"==typeof e.message}(e.error))}(r.data))&&e(r.data,r)}}function a(e){try{return"function"==typeof e.then}catch(e){}return!1}
/*!
 * Copyright (c) 2017 Digital Bazaar, Inc. All rights reserved.
 */const l=3e4;class c{constructor(){this.origin=null,this._handle=null,this._listener=null,this._pending=new Map}async connect(e,t){if(this._listener)throw new Error("Already connected.");t=t||{};this.origin=r(e).origin,this._handle=t.handle||window.parent||window.opener;const n=this._pending;return this._listener=s({origin:this.origin,handle:this._handle,expectRequest:!1,listener:e=>{if(!(e.id in n))return;const{resolve:t,reject:i,cancelTimeout:r}=n[e.id];if(r(),"result"in e)return t(e.result);i(function(e){let t;return"DOMException"===e.constructor?t=new DOMException(e.message,e.name):(t=new Error(e.message),"code"in e&&(t.code=e.code)),e.details&&(t.details=e.details),t}(e.error))}}),window.addEventListener("message",this._listener),new d(this)}async send(e,t,{timeout:n=l}){if(!this._listener)throw new Error("RPC client not connected.");const i=this,r={jsonrpc:"2.0",id:function(e,t){for(t=e="";e++<36;t+=51*e&52?(15^e?8^Math.random()*(20^e?16:4):4).toString(16):"-");return t}(),method:e,params:t};if(a(i._handle)){(await i._handle).postMessage(r,i.origin)}else i._handle.postMessage(r,i.origin);return new Promise((e,t)=>{const o=i._pending;let s;if(n>0){const e=setTimeout(()=>{delete o[r.id],t(new Error("RPC call timed out."))},n);s=(()=>clearTimeout(e))}else s=(()=>{});o[r.id]={resolve:e,reject:t,cancelTimeout:s}})}close(){this._listener&&(window.removeEventListener("message",this._listener),this._handle=this.origin=this._listener=null,this._pending=new Map)}}class d{constructor(e){this.client=e,this._apis=new Map}define(e,t){if(!e||"string"!=typeof e)throw new TypeError("`name` must be a non-empty string.");if(!t||"object"!=typeof t||!Array.isArray(t.functions))throw new TypeError("`definition.function` must be an array of function names or function definition objects to be defined.");const n=this,i={};return t.functions.forEach(t=>{"string"==typeof t&&(t={name:t,options:{}}),i[t.name]=async function(){return n.client.send(e+"."+t.name,[...arguments],t.options)}}),n._apis[e]=i,i}get(e,t){if(!this._apis[e]){if(t)return this.define(e,t);throw new Error(`API "${e}" has not been defined.`)}return this._apis[e]}}
/*!
 * Copyright (c) 2017 Digital Bazaar, Inc. All rights reserved.
 */class h{constructor({deserialize:e=(e=>e),waitUntil:t=(async()=>{})}={}){this._listeners=[],this._deserialize=e,this._waitUntil=t}async emit(e){return e=this._deserialize(e),(this._listeners[e.type]||[]).forEach(t=>t(e)),this._waitUntil(e)}addEventListener(e,t){this._listeners[e]?this._listeners[e].push(t):this._listeners[e]=[t]}removeEventListener(e,t){const n=this._listeners[e];if(!n)return;const i=n.indexOf(t);-1!==i&&n.splice(i,1)}}
/*!
 * Copyright (c) 2017 Digital Bazaar, Inc. All rights reserved.
 */class u{constructor(){this.origin=null,this._handle=null,this._apis=new Map}define(e,t){if(!e||"string"!=typeof e)throw new TypeError("`name` must be a non-empty string.");if(!t||"object"===t)throw new TypeError("`api` must be an object.");if(e in this._apis)throw new Error(`The "${e}" API is already defined.`);this._apis[e]=t}async listen(e,t){if(this._listener)throw new Error("Already listening.");t=t||{};const n=this;n.origin=r(e).origin,n._handle=t.handle||window.parent||window.opener;const o="true"===t.ignoreUnknownApi||!1;n._listener=s({origin:n.origin,handle:n._handle,expectRequest:!0,listener:e=>{const{name:t,method:r}=function(e){let[t,...n]=e.split(".");const i=n.pop();return{name:t=[t,...n].join("."),method:i}}(e.method),s=n._apis[t];if(r&&r.startsWith("_"))return p(n._handle,n.origin,e);if(!s&&o)return;if(!s||"function"!=typeof s[r])return p(n._handle,n.origin,e);const l=s[r];(async()=>{const t={jsonrpc:"2.0",id:e.id};try{t.result=await l.apply(s,e.params)}catch(e){t.error=function(e){const t={message:e.message};return"Error"!==e.constructor.name&&(t.constructor=e.constructor.name),"name"in e&&(t.name=e.name),t.code="code"in e?e.code:i.ServerError.code,"details"in e&&(t.details=e.details),t}(e)}n._handle&&(a(n._handle)?n._handle.then(e=>e.postMessage(t,n.origin)):n._handle.postMessage(t,n.origin))})()}}),window.addEventListener("message",n._listener)}close(){this._listener&&(window.removeEventListener("message",this._listener),this._handle=this.origin=this._listener=null)}}function p(e,t,n){const r={jsonrpc:"2.0",id:n.id,error:Object.assign({},i.MethodNotFound)};return a(e)?e.then(e=>e.postMessage(r,t)):e.postMessage(r,t)}
/*!
 * A WebApp is a remote application that runs in a WebAppContext.
 *
 * Copyright (c) 2017 Digital Bazaar, Inc. All rights reserved.
 */class w{constructor(e){this.relyingOrigin=r(e).origin,this.client=null,this.injector=null,this.client=new c,this.server=new u,this._control=null,this._connected=!1}async connect(){return this.injector=await this.client.connect(this.relyingOrigin),this._connected=!0,this._control=this.injector.define("core.control",{functions:["ready","show","hide"]}),this.server.listen(this.relyingOrigin),this.injector}async ready(){if(!this._connected)throw new Error('WebApp not connected. Did you call ".connect()"?');return await this._control.ready(),this}close(){this._connected&&(this.server.close(),this.client.close(),this._connected=!1)}async show(){if(!this._connected)throw new Error('Cannot "show" yet; not connected. Did you call ".connect()"?');return this._control.show()}async hide(){if(!this._connected)throw new Error('Cannot "hide" yet; not connected. Did you call ".connect()?"');return this._control.hide()}}
/*!
 * Copyright (c) 2017-2018 Digital Bazaar, Inc. All rights reserved.
 */const m=1e4;class g{constructor(e,{timeout:t=m,handle:n,iframe:i,windowControl:r,className:o=null,customize:s=null}={}){const a=this;if(a.visible=!1,a.dialog=null,a.iframe=null,a.handle=null,a.windowControl=null,a._ready=!1,a._private={},a._private._readyPromise=new Promise((e,n)=>{const i=setTimeout(()=>n(new Error("Loading Web application window timed out.")),t);a._private._resolveReady=(t=>{clearTimeout(i),e(t)})}),a._private.isReady=(async()=>a._private._readyPromise),a._private.destroy=(()=>{a.dialog&&(a.dialog.parentNode.removeChild(a.dialog),a.dialog=null)}),i){if("object"!=typeof i||!i.contentWindow)throw new TypeError("`options.iframe` must be an iframe element.");return a.windowControl={handle:i.contentWindow,show(){i.style.visibility="visible"},hide(){i.style.visibility="hidden"}},a.iframe=i,void(a.handle=a.iframe.contentWindow)}if(r)return a.windowControl=r,void(a.handle=a.windowControl.handle);if(n)return void(a.handle=n);a.dialog=document.createElement("dialog"),f(a.dialog,{position:"fixed",top:0,right:0,bottom:0,left:0,width:"auto",height:"auto",display:"none",margin:0,padding:0,border:"none",background:"transparent",color:"black","box-sizing":"border-box",overflow:"hidden","z-index":1e6}),a.dialog.className="web-app-window","string"==typeof o&&(a.dialog.className=a.dialog.className+" "+o);const l=document.createElement("style");if(l.appendChild(document.createTextNode("dialog.web-app-window::backdrop {\n        background-color: transparent;\n      }")),a.container=document.createElement("div"),f(a.container,{position:"relative",width:"100vw",height:"100vh",margin:0,padding:0,display:"flex","flex-direction":"column"}),a.iframe=document.createElement("iframe"),a.iframe.src=e,a.iframe.scrolling="no",f(a.iframe,{position:"relative",border:"none",background:"transparent",overflow:"hidden",margin:0,padding:0,"flex-grow":1,width:"100%",height:"100%"}),a.dialog.appendChild(l),a.container.appendChild(a.iframe),a.dialog.appendChild(a.container),a.dialog.addEventListener("cancel",e=>{e.preventDefault(),a.hide()}),document.body.appendChild(a.dialog),a.handle=a.iframe.contentWindow,s)try{s({dialog:a.dialog,container:a.container,iframe:a.iframe,webAppWindow:a})}catch(e){console.error(e)}}ready(){this._ready=!0,this._private._resolveReady(!0)}show(){this.visible||(this.visible=!0,this.dialog?(this.dialog.style.display="block",this.dialog.showModal&&this.dialog.showModal()):this.windowControl.show&&this.windowControl.show())}hide(){if(this.visible)if(this.visible=!1,this.dialog){if(this.dialog.style.display="none",this.dialog.close)try{this.dialog.close()}catch(e){console.error(e)}}else this.windowControl.hide&&this.windowControl.hide()}}function f(e,t){for(let n in t)e.style[n]=t[n]}
/*!
 * Copyright (c) 2017 Digital Bazaar, Inc. All rights reserved.
 */const y=1e4;class _{constructor(){this.client=new c,this.server=new u,this.injector=null,this.control=null,this.loaded=!1}async createWindow(e,{timeout:t=y,iframe:n,handle:i,windowControl:o,className:s,customize:a}={}){if(this.loaded)throw new Error("AppContext already loaded.");this.loaded=!0,this.control=new g(e,{timeout:t,iframe:n,handle:i,windowControl:o,className:s,customize:a}),this.server.define("core.control",this.control);const l=r(e).origin;return this.server.listen(l,{handle:this.control.handle,ignoreUnknownApi:!0}),await this.control._private.isReady(),this.injector=await this.client.connect(l,{handle:this.control.handle}),this.injector}close(){this.control._private.destroy(),this.server.close(),this.client.close()}}
/*!
 * JSON-RPC for Web Request Polyfills.
 *
 * Copyright (c) 2017 Digital Bazaar, Inc. All rights reserved.
 */
/*!
 * A CredentialRequestEvent is emitted when a request has been made for
 * credentials.
 *
 * Copyright (c) 2017 Digital Bazaar, Inc. All rights reserved.
 */class v{constructor({credentialHandler:e,credentialRequestOrigin:t,credentialRequestOptions:n,hintKey:i}){this.type="credentialrequest",this._credentialHandler=e,this.credentialRequestOrigin=t,this.credentialRequestOptions=n,this.hintKey=i}async openWindow(e){await this._credentialHandler.show();const t=new g(e,{className:"credential-handler"});return t.ready(),t.show(),t.handle}respondWith(e){this._promise=e}}
/*!
 * A CredentialStoreEvent is emitted when a request has been made to
 * store a credential.
 *
 * Copyright (c) 2017 Digital Bazaar, Inc. All rights reserved.
 */class b{constructor({credentialHandler:e,credentialRequestOrigin:t,credential:n,hintKey:i}){this.type="credentialstore",this._credentialHandler=e,this.credentialRequestOrigin=t,this.credential=n,this.hintKey=i}async openWindow(e){await this._credentialHandler.show();const t=new g(e);return t.ready(),t.show(),t.handle}respondWith(e){this._promise=e}}
/*!
 * A CredentialHandlerService handles remote calls to a CredentialHandler.
 *
 * Copyright (c) 2017 Digital Bazaar, Inc. All rights reserved.
 */class E{constructor(e){this._credentialHandler=e}async request(e){return await this._credentialHandler._emitter.emit(new v(Object.assign({credentialHandler:this._credentialHandler},e)))}async store(e){return await this._credentialHandler._emitter.emit(new b(Object.assign({credentialHandler:this._credentialHandler},e)))}}
/*!
 * The core CredentialHandler class.
 *
 * Copyright (c) 2017 Digital Bazaar, Inc. All rights reserved.
 */const C=["credentialrequest","credentialstore"];class j extends w{constructor(e){if("string"!=typeof e)throw new TypeError('"mediatorOrigin" must be a string.');super(e),this._emitter=new h({waitUntil:async e=>e._promise||Promise.reject(new DOMException('No "credentialrequest" event handler found.',"NotFoundError"))})}async connect(){const e=await super.connect();return this.server.define("credentialHandler",new E(this)),await this.ready(),e}addEventListener(e,t){if(!C.includes(e))throw new DOMException(`Unsupported event type "${e}"`,"NotSupportedError");return this._emitter.addEventListener(e,t)}removeEventListener(e,t){if(!C.includes(e))throw new DOMException(`Unsupported event type "${e}"`,"NotSupportedError");return this._emitter.removeEventListener(e,t)}}
/*!
 * API for managing CredentialHints.
 *
 * Copyright (c) 2017 Digital Bazaar, Inc. All rights reserved.
 */class M{constructor(e,t){const n=t.get("credentialHints",{functions:["delete","get","keys","has","set","clear"]});for(let t in n)"set"!==t&&(this[t]=n[t].bind(this,e));this._remoteSet=n.set.bind(this,e)}async set(e,t){t.icons=t.icons||[];const n=t.icons.map(e=>(function(e){return new Promise(t=>{const n=new Image;n.crossOrigin="Anonymous",n.onload=(()=>{let e=document.createElement("canvas");const i=e.getContext("2d");e.height=n.height,e.width=n.width,i.drawImage(n,0,0);const r=e.toDataURL();t(r),e=null}),n.onerror=(()=>t(null)),n.src=e})}
/*!
 * A CredentialManager for a Web Credential Mediator.
 *
 * Copyright (c) 2017 Digital Bazaar, Inc. All rights reserved.
 */)(e.src).then(t=>{e.fetchedImage=t}));return await Promise.all(n),this._remoteSet(e,t)}}class O{constructor(e,t){if(!e||"string"!=typeof e)throw new TypeError('"url" must be a non-empty string.');this.hints=new M(e,t)}static async requestPermission(){return(await navigator.credentialsPolyfill.permissions.request({name:"credentialhandler"})).state}}
/*!
 * A CredentialHandlerRegistration provides a CredentialManager to enable Web
 * apps to register Profiles that can be presented to websites.
 *
 * Copyright (c) 2017 Digital Bazaar, Inc. All rights reserved.
 */class x{constructor(e,t){if(!e||"string"!=typeof e)throw new TypeError('"url" must be a non-empty string.');this.credentialManager=new O(e,t)}}
/*!
 * Provides an API for working with CredentialHandlerRegistrations.
 *
 * Copyright (c) 2017 Digital Bazaar, Inc. All rights reserved.
 */class R{constructor(e){this._injector=e,this._remote=e.get("credentialHandlers",{functions:["register","unregister","getRegistration","hasRegistration"]})}async register(e){return e=await this._remote.register("credential",e),new x(e,this._injector)}async unregister(e){return this._remote.unregister("credential",e)}async getRegistration(e){return(e=await this._remote.getRegistration("credential",e))?new x(e,this._injector):null}async hasRegistration(e){return await this._remote.hasRegistration("credential",e)}}
/*!
 * A WebCredential is a Credential that can be retrieved from or stored by a
 * "credential handler" that runs in a third party Web application.
 *
 * Copyright (c) 2017 Digital Bazaar, Inc. All rights reserved.
 */class N{constructor(e,t){if("string"!=typeof e)throw new TypeError('"dataType" must be a string.');this.type="web",this.dataType=e,this.data=t}}
/*!
 * Wrapper for native CredentialsContainer that uses remote Credential Mediator
 * for WebCredential-related operations.
 *
 * Copyright (c) 2017 Digital Bazaar, Inc. All rights reserved.
 */const T=0,P=0;class S{constructor(e){this._nativeCredentialsContainer=navigator.credentials,this._remote=e.get("credentialsContainer",{functions:[{name:"get",options:{timeout:T}},{name:"store",options:{timeout:P}}]})}async get(e={}){if(e.web){const t=await this._remote.get(e);return t?new N(t.dataType,t.data):null}if(this._nativeCredentialsContainer)return this._nativeCredentialsContainer.get(e);throw new DOMException("Not implemented.","NotSupportedError")}async store(e){if(e instanceof N){const t=await this._remote.store(e);return t?new N(t.dataType,t.data):null}if(this._nativeCredentialsContainer)return this._nativeCredentialsContainer.store(e);throw new DOMException("Not implemented.","NotSupportedError")}async create(e={}){if(this._nativeCredentialsContainer)return this._nativeCredentialsContainer.create(e);throw new DOMException("Not implemented.","NotSupportedError")}async preventSilentAccess(){if(this._nativeCredentialsContainer)return this._nativeCredentialsContainer.preventSilentAccess();throw new DOMException("Not implemented.","NotSupportedError")}}
/*!
 * Credential Handler API Polyfill.
 *
 * Copyright (c) 2017 Digital Bazaar, Inc. All rights reserved.
 */const q=0;async function H(e){const t={};e||(e="https://credential.mediator.dev:15443/mediator?origin="+encodeURIComponent(window.location.origin));const n=new _,i=await n.createWindow(e,{className:"credential-mediator"});return t.permissions=i.get("permissionManager",{functions:["query",{name:"request",options:{timeout:q}},"revoke"]}),t.CredentialHandlers=new R(i),t.CredentialHandler=j,t.CredentialManager=O,t.credentials=new S(i),t.WebCredential=N,navigator.credentialsPolyfill=t,"credentials"in navigator?(navigator.credentials.get=t.credentials.get.bind(t.credentials),navigator.credentials.store=t.credentials.store.bind(t.credentials)):navigator.credentials=t.credentials,window.CredentialManager=O,window.WebCredential=N,t}console.log("test"),H().then(e=>{console.log(`Got polyfill: ${JSON.stringify(e)}`)},e=>{console.error(`Promise rejected with error: ${e}`)})}]);